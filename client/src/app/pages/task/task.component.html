
<nb-card>

  <nb-card-header>
    <div class="row">
      <div class="col-sm-9">
        <span class="card-heading">
          Task
       </span>
      </div>
      <div class="col-sm-3">
        <button class="header-button" id="header-btn" (click)="addTask()"nbButton status="primary">Add Task</button>
      </div>
    </div>
    

</nb-card-header>

   <nb-card-body>
    <h5 style="text-align: center;color:rgb(23, 23, 96)">{{siteNameForHeader}} - {{locationNameForHeader}}</h5>

<div  *ngFor = "let item of gridData;index as i">

 
      <div class="row">
        <div class="col-sm-4">
          <span class="duration-class"><b>Start Date:</b>&nbsp;{{item.startDate |date}}&nbsp;<b>End Date:</b>&nbsp;{{item.endDate |date}}&nbsp;<i (click) = "updateCalednder($event,i)" *ngIf="calenderHide" class="fa">&#xf073;</i><input type="date" *ngIf="!calenderHide"  [(ngModel)]="calenderFrom" (change)="handler(item)"></span>
        </div>
        <div class="col-sm-4">
          <span class="duration-class"><b>Task Name : </b>&nbsp;{{item.taskName}}</span>
   
        </div>
        <div class="col-sm-2" id="header-btn1">
          <button class="btn btn-danger" (click)="delete(item)">Delete Task</button>
        </div>
        <div class="col-sm-2" id="header-btn1">
          <button class="btn btn-primary" (click)="saveData(item)" *ngIf="isEdit">Update Task</button>
        </div>
       
      </div>

   <div class="row">
    <div class="col-sm-2 add-row mt-2" >
      <button class="btn btn-success" (click)="addRow(item)">Add Row</button>
    </div>
    <div class="col-sm-12 table ">
      <table id="customers">
        <thead>
          <tr>
            <th>Worker's Name</th>
            <th>Contact</th>
            <th>Charge (â‚¹)</th>
            <th>Action</th>
            </tr>
        </thead>
       
          <tbody id="newtable" >
            <tr *ngFor = "let labour of item.laboursArray;let j =index">
              <td  id="name"><input type="text" [(ngModel)]="labour.name" [ngClass]="!labour.isEdit ? 'input-border' : 'input-not-border'" [disabled]="labour.isEdit"></td>
              <td id="contact"><input type="text" [(ngModel)]="labour.contact"  [ngClass]="!labour.isEdit ? 'input-border' : 'input-not-border'" [disabled]="labour.isEdit"></td>
              <td id="charge"><input type="text" [(ngModel)]="labour.charge"  [ngClass]="!labour.isEdit ? 'input-border' : 'input-not-border'" [disabled]="labour.isEdit"></td>
              <td>
                <div class="row">
                  <div class="col-sm-1 offset-sm-1" *ngIf="item.laboursArray.length !=1">
                    <button class="del"  data-toggle="tooltip" (click)="remove(j,item)" data-placement="top" title="Remove">
                      <img src="../../../assets/icon/delete.png">
                      <!-- <i   [ngStyle]="(styleOne && byIndexingChangeColor == i  ) ?  {'color': 'red','font-size':'22px'} : {'color': 'grey','font-size':'22px'} " title="Delete"  data-toggle="tooltip" class="fa">&#xf014;</i> -->
                    </button>
                  </div>
                  <div class="col-sm-1 offset-sm-1">
                    <button class="del"  data-toggle="tooltip" data-placement="top" title="Edit"  (click)="editBox(item,j)">
                      <img src="../../../assets/icon/edit.png">
                      <!-- <i   [ngStyle]="(styleOne && byIndexingChangeColor == i  ) ?  {'color': 'red','font-size':'22px'} : {'color': 'grey','font-size':'22px'} " title="Delete"  data-toggle="tooltip" class="fa">&#xf014;</i> -->
                    </button>
                  </div>

                  <div class="col-sm-1 offset-sm-1">
                    <button class="del"  data-toggle="tooltip" data-placement="top" (click)="viewImage(item)" title="Image">
                      <img src="../../../assets/icon/gallery.png">
                      <!-- <i   [ngStyle]="(styleOne && byIndexingChangeColor == i  ) ?  {'color': 'red','font-size':'22px'} : {'color': 'grey','font-size':'22px'} " title="Delete"  data-toggle="tooltip" class="fa">&#xf014;</i> -->
                    </button>
                  </div>
                 
                  <div class="col-sm-1 offset-sm-1">
                    <button class="del"  data-toggle="tooltip" (click)="viewRecord(labour,item)" data-placement="top" title="Record">
                      <img src="../../../assets/icon/report.png">
                      <!-- <i   [ngStyle]="(styleOne && byIndexingChangeColor == i  ) ?  {'color': 'red','font-size':'22px'} : {'color': 'grey','font-size':'22px'} " title="Delete"  data-toggle="tooltip" class="fa">&#xf014;</i> -->
                    </button>
                  </div>
                 




                 <div class="col-sm-1 offset-sm-1">
                  <button class="image-upload" (click)="viewCaledner(i,j,labour,item)" toggle="tooltip"  data-placement="data-top" title="Attendence">
                    <span>
                      <label for="date-picker"  tabindex="0">       
                        <img src="../../../assets/icon/calender.webp">    
                    </label>
                    </span>
                    <span>
                      <input type="date" class="date-control"  (change)= "handleDateClick($event);" id="date-picker">
                    </span>
                    
                    
                 
                  </button>
                 </div>
                  
            
               
               
                  
                  </div>
              </td>
              <!-- <td><i  *ngIf="labour.actionBtn" (click)="viewCaledner(i,j,labour,item)" style="color:#f9a805;" class="fa">&#xf073;</i><input type="date"  *ngIf="!labour.actionBtn"  (change)= "handleDateClick($event);"> &nbsp;<i   *ngIf="!labour.actionBtn"  (click)="removeCalender(i,j,labour,item)"style="font-size:16px" style="color:red" class="fa">&#xf00d;</i></td>
            
             
              <td><i   (click)="viewRecord(labour,item)" class="fa" style="color: #0095ff">&#xf06e;</i></td>
            <td>
              <i class="fa fa-picture-o" (click)="viewImage(item)" style="color: #db8b00" aria-hidden="true"></i>
            </td> -->
            </tr>
          </tbody>
       
       
      </table>
        </div>
        </div>

  <br>
</div>
</nb-card-body>
</nb-card>



<ng-template #dialogdelete let-data let-ref="dialogRef">
  <nb-card  style="width:500px">
    <nb-card-header>Delete Task</nb-card-header>
    <nb-card-body>
     Are You Sure You Want To Delete This Task?
    </nb-card-body>
    <nb-card-footer>
      <button nbButton status="warning" (click)="removeTask()">Delete</button>&nbsp; &nbsp;<button nbButton status="basic" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #dialogview let-data let-ref="dialogRef">
  <nb-card  style="width:950px" class="imageClass">
    <nb-card-header><h5>View Gallery</h5>
  <button type="submit" class="leave-btn" nbButton hero status="success" (click)="showWorkers()">Workers</button>
    </nb-card-header>
    <nb-card-body>
     
      <div class="row" *ngIf="!workerShow">
        <div class="col-sm-4"  *ngFor="let item of imageGallery">
          <div > 
            <img src="{{item}}" height="200px" width="200px">
          </div> 
        </div>
      </div>

</nb-card-body>
    <nb-card-footer>
      <button nbButton status="warning" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #dialogcalenderStatement let-data let-ref="dialogRef">
  <nb-card  style="width:500px">
    <nb-card-header>
      Selected Date : {{selectedDate | date}}
    </nb-card-header>
    <nb-card-body>
      <div class="form-group row">
      
        <label for="siteName"  class="label col-sm-2 col-form-label">Add P / A</label>
        <div class="col-sm-4">
          <input type="text" nbInput fullWidth [(ngModel)]="attendecne"  id="work"  >
          <!-- <span *ngIf="error.designation" class="required">*Required</span>   -->
      </div>
      <label for="siteLoc"   class="label  col-sm-2 col-form-label">Over Time in hours</label>
        <div class="col-sm-4">
          <input type="text" nbInput fullWidth [(ngModel)]="overTime"  id="work"  >
       
      </div>
      </div>
      <div class="form-group row">
      
        <label for="siteName"  class="label col-sm-2 col-form-label">Advance Payment</label>
        <div class="col-sm-4">
          <input type="text" nbInput fullWidth [(ngModel)]="advancePayment"  id="work"  >
          <!-- <span *ngIf="error.designation" class="required">*Required</span>   -->
      </div>
    
        <div class="col-sm-4">
         
       
      </div>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <button nbButton status="warning" (click)="submitWork()">Submit</button>&nbsp; &nbsp;<button nbButton status="basic" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #dialogRecordView let-data let-ref="dialogRef">
  <nb-card class="imageClass">
    <nb-card-header>View Record
 
    </nb-card-header>
    <nb-card-body  id="dialog-card-task">
      <button type="submit" class="leave-btn" nbButton hero status="success" (click)="showPayment()">Payment</button>
      <br>
        <div class="flex-parent">
          <div class="flex-item">
          <b style="color:rgb(44, 97, 44)">Worker's Payment:</b> {{totaalPaymentOfWorker}}
          </div>
          <div class="flex-item">
            <b style="color:rgb(168, 69, 11)">Paid Payment:</b> {{totalPaymentPaid}}
          </div>
          <div class="flex-item">
            <b style="color:rgb(10, 71, 121)">Pending Payment:</b> {{totalPaymentPending}}
          </div>
        
     </div><br>
      <table id="customers2">
        <tr *ngFor="let key of totalWorkey">
          <th>{{key | titlecase}}</th>
          <td *ngFor="let data of totalWork">
              {{data[key]}}
          </td>
      </tr>
       </table>
   


</nb-card-body>
    <nb-card-footer>
      <button nbButton status="warning" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #dialogPaymentView let-data let-ref="dialogRef">
  <nb-card  style="width:950px" class="imageClass">
    <nb-card-header>Payment
 
    </nb-card-header>
    <nb-card-body>
      <div class="form-group row">
        <label for="siteName"  class="label col-sm-2 col-form-label">From Date</label>
        <div class="col-sm-4">
            <input type="date" [(ngModel)]="fromDate" [ngModelOptions]="{standalone: true}" required>
          
          <!-- <span *ngIf="error.designation" class="required">*Required</span>   -->
      </div>
      <label for="siteLoc"   class="label  col-sm-2 col-form-label">To Date</label>
        <div class="col-sm-4">
          <input type="date" [(ngModel)]="toDate" [ngModelOptions]="{standalone: true}" required>
         </div>
         </div>
    </nb-card-body>
    <nb-card-footer>
      <button nbButton status="primary" (click)="submitPayment()">Submit</button>&nbsp; &nbsp; <button nbButton status="warning" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #dialogviewImage let-data let-ref="dialogRef">
  <nb-card  style="width:950px" class="imageClass">
    <nb-card-header><h5 style="color:white">
      View Gallery
    </h5></nb-card-header>
    <nb-card-body>
      <div class="row">
          <div class="col-sm-2" *ngFor="let img of urlOFFirebae" >
            <div *ngIf= "getExtensionOfFile(img)=='mp4'">
              <video [src]="img"  controls>
                Your browser does not support HTML5 video.
            </video>
              
            </div> 
            <div *ngIf= "getExtensionOfFile(img) !='mp4'">
              <a  href="" >
                <img [src]="img" >
              </a>
              
            </div>
          </div>
      
       
       
        <!-- <h6>Uploaded Date : {{item.uploaded|date}}</h6>
       
        <div class="col-sm-2"   *ngFor = "let img of item.fireBaseUrl">
          
          <div *ngIf= "getExtensionOfFile(img)=='mp4'">
            <video [src]="img" controls>
              Your browser does not support HTML5 video.
          </video>
            
          </div> 
          <div *ngIf= "getExtensionOfFile(img) !='mp4'">
            <img [src]="img">
          </div>
        </div> -->
      </div>
   
    </nb-card-body>
    <nb-card-footer>
      <button nbButton status="warning" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>